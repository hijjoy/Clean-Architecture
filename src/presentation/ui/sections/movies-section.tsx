import { Suspense } from "react";
import { useMovies } from "../../hooks/use-movies";
import { MovieList } from "../components/movie-list";
import { Skeleton } from "../components/skeleton";
import { MoviesHeader } from "../components/movies-header";
import { LoadMoreButton } from "../components/load-more-button";

/**
 * ğŸ“ PRESENTATION LAYER - SECTION
 *
 * ì—­í• : íŠ¹ì • ê¸°ëŠ¥ ì˜ì—­ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
 * - UseCaseë¥¼ DI Containerì—ì„œ ê°€ì ¸ì˜¤ê¸°
 * - í•´ë‹¹ ì„¹ì…˜ì˜ ìƒíƒœ ê´€ë¦¬
 * - ì»´í¬ë„ŒíŠ¸ë“¤ì„ ì¡°í•©í•˜ì—¬ ê¸°ëŠ¥ êµ¬í˜„
 */

export function MoviesSection() {
  // TODO: ì¶”í›„ tanstack queryë¥¼ ì´ìš©í•˜ë©° ìˆ˜ì • ì˜ˆì •
  const { movies, loading, error, hasNextPage, loadNextPage, refresh } =
    useMovies();

  return (
    <Suspense fallback={<MoviesSectionSkeleton />}>
      <MoviesHeader loading={loading} onRefresh={refresh} />
      <MovieList
        movies={movies}
        loading={loading}
        error={error}
        hasNextPage={hasNextPage}
        onLoadMore={loadNextPage}
        onRefresh={refresh}
      />
      <LoadMoreButton
        hasNextPage={hasNextPage}
        loading={loading}
        onLoadMore={loadNextPage}
      />
    </Suspense>
  );
}

function MoviesSectionSkeleton() {
  return <Skeleton message="ì˜í™” ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..." />;
}
